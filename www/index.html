<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/main.css">
    <script src="./js/eb.min.js"></script> <!-- Must load first! -->
    <script src="./js/behaviors/click-counter.js"></script>
    <script src="./js/main.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/stackoverflow-dark.min.css">
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/stackoverflow-light.min.css"> -->
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.9.0/build/highlight.min.js"></script>
</head>
    <script>hljs.highlightAll();</script>
<body>
    <div id="container">
        <aside>
            <h2 id="table-of-contents">Table of Contents</h2>
            <ul>
                <li>
                    <a href="#introduction">Introduction</a>
                </li>
                <li>
                    <a href="#getting-started">Getting Started</a>
                </li>
                <li>
                    <a href="#defining-behaviors">Defining Behaviors</a>
                </li>
                <li>
                    <a href="#using-behaviors">Using Behaviors</a>
                </li>
                <li>
                    <a href="#lifecycle-callbacks">Lifecycle Callbacks</a>
                </li>
                <li>
                    <a href="#api-reference">API Reference</a>
                </li>
                <li>
                    <a href="#limitations-and-modified-behavior">Limitations and Modified Behavior</a>
                </li>
                <li>
                    <a href="#examples">Examples</a>
                </li>
            </ul>
            <button id="theme-selector" class="theme-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 4c-4.418 0-8 3.582-8 8s3.582 8 8 8v-16z"/></svg>
                Theme
            </button>
            <div id="theme-options">
                <button class="theme-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm0 4c-4.418 0-8 3.582-8 8s3.582 8 8 8v-16z"/></svg>
                    Device Default
                </button>
                <button class="theme-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M22.088 13.126l1.912-1.126-1.912-1.126c-1.021-.602-1.372-1.91-.788-2.942l1.093-1.932-2.22-.02c-1.185-.01-2.143-.968-2.153-2.153l-.02-2.219-1.932 1.093c-1.031.583-2.34.233-2.941-.788l-1.127-1.913-1.127 1.913c-.602 1.021-1.91 1.372-2.941.788l-1.932-1.093-.02 2.219c-.01 1.185-.968 2.143-2.153 2.153l-2.22.02 1.093 1.932c.584 1.032.233 2.34-.788 2.942l-1.912 1.126 1.912 1.126c1.021.602 1.372 1.91.788 2.942l-1.093 1.932 2.22.02c1.185.01 2.143.968 2.153 2.153l.02 2.219 1.932-1.093c1.031-.583 2.34-.233 2.941.788l1.127 1.913 1.127-1.913c.602-1.021 1.91-1.372 2.941-.788l1.932 1.093.02-2.219c.011-1.185.969-2.143 2.153-2.153l2.22-.02-1.093-1.932c-.584-1.031-.234-2.34.788-2.942zm-10.117 6.874c-4.411 0-8-3.589-8-8s3.588-8 8-8 8 3.589 8 8-3.589 8-8 8zm6.029-8c0 3.313-2.687 6-6 6s-6-2.687-6-6 2.687-6 6-6 6 2.687 6 6z"/></svg>
                    Light Mode
                </button>
                <button class="theme-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 10.999c1.437.438 2.562 1.564 2.999 3.001.44-1.437 1.565-2.562 3.001-3-1.436-.439-2.561-1.563-3.001-3-.437 1.436-1.562 2.561-2.999 2.999zm8.001.001c.958.293 1.707 1.042 2 2.001.291-.959 1.042-1.709 1.999-2.001-.957-.292-1.707-1.042-2-2-.293.958-1.042 1.708-1.999 2zm-1-9c-.437 1.437-1.563 2.562-2.998 3.001 1.438.44 2.561 1.564 3.001 3.002.437-1.438 1.563-2.563 2.996-3.002-1.433-.437-2.559-1.564-2.999-3.001zm-7.001 22c-6.617 0-12-5.383-12-12s5.383-12 12-12c1.894 0 3.63.497 5.37 1.179-2.948.504-9.37 3.266-9.37 10.821 0 7.454 5.917 10.208 9.37 10.821-1.5.846-3.476 1.179-5.37 1.179z"/></svg>
                    Dark Mode
                </button>
            </div>
        </aside>
        <main>
            <h1 id="element-behaviors">Element Behaviors</h1>
            <p>
                Element Behaviors is a <a href="https://github.com/caboodle-tech/element-behaviors" target="_blank">JavaScript library</a> that allows you to define and apply reusable behaviors to HTML elements. It follows the Custom Elements specifications closely, providing a way to encapsulate and compose functionality onto elements without the restrictions of Custom Elements.
            </p>
            <h2 id="introduction">Introduction</h2>
            <p>
                Element Behaviors allows you to enhance HTML elements with reusable behaviors. These behaviors can be defined, applied, and managed using the Element Behaviors library.
            </p>
            <h2 id="getting-started">Getting Started</h2>
            <p>
                To use Element Behaviors, include the library in your project. You can download it from <a href="https://github.com/caboodle-tech/element-behaviors?tab=readme-ov-file#installation">GitHub</a> or include it via a CDN script tag:
            </p>
            <pre><code>&lt;!-- For the latest release. --&gt;
&lt;script src="https://cdn.jsdelivr.net/gh/caboodle-tech/element-behaviors@main/dist/eb.min.js"&gt;&lt;/script&gt;

&lt;!-- For older releases that have been tagged. Replace [TAG] with the proper semver number. --&gt;
&lt;script src="https://cdn.jsdelivr.net/gh/caboodle-tech/element-behaviors@[TAG]/dist/eb.min.js"&gt;&lt;/script&gt;</code></pre>
            <h2 id="defining-behaviors">Defining Behaviors</h2>
            <p>
                Behaviors are defined as JavaScript classes. Here is an example of a behavior that counts clicks:
            </p>
            <div class="callout">
                <svg clip-rule="evenodd" fill-rule="evenodd" stroke-linejoin="round" stroke-miterlimit="2" viewBox="0 0 24 24" width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="m2 4v16.002c0 .385.22.735.567.902.346.166.758.119 1.058-.121l4.725-3.781h12.65c.552 0 1-.448 1-1v-12.002c0-.552-.448-1-1-1h-18c-.552 0-1 .448-1 1zm18.5 11.502h-12.677l-4.323 3.46v-14.462h17zm-8.502-6.5c.414 0 .75.336.75.75v3.5c0 .414-.336.75-.75.75s-.75-.336-.75-.75v-3.5c0-.414.336-.75.75-.75zm.002-3c.552 0 1 .448 1 1s-.448 1-1 1-1-.448-1-1 .448-1 1-1z" fill-rule="nonzero"/></svg>
                <p>
                    This example could be simplified by removing the <code>observedAttributes</code> feature. This allows the counter to be updated by modifying the <code>count</code> attribute in addition to clicking on the element.
                </p>
            </div>
            <pre><code>class ClickCounter {

    static observedAttributes = ['count'];

    #count;
    #element;
    #listener;

    constructor(element) {
        this.#element = element;
        this.#listener = this.incrementCount.bind(this);

        // Use the existing count if the attribute exists
        if(element.hasAttribute('count')) {
            const count = Number(element.getAttribute('count')) || Number(0);
            this.#count = count;
            return;
        }

        // Count attribute was missing so add it now
        element.setAttribute('count', 0);
        this.#count = 0;
    }

    connectedCallback() {
        this.render();
        this.#element.addEventListener('click', this.#listener);
    }

    incrementCount() {
        const count = Number(this.#element.getAttribute('count')) || Number(this.#count);
        this.#element.setAttribute('count', count + 1);
    }

    disconnectedCallback() {
        this.#element.removeEventListener('click', this.#listener);
    }

    render() {
        this.#element.textContent = `Count: ${this.#count}`;
    }

    attributeChangedCallback(name, oldValue, newValue) {
        if (name !== 'count') {
            return;
        }
        this.#count = Number(newValue) || Number(oldValue) || 0;
        this.render();
    }

}

elementBehaviors.define('click-counter', ClickCounter);</code></pre>
            <h2 id="using-behaviors">Using Behaviors</h2>
            <p>
                To use a defined behavior, register it with Element Behaviors:
            </p>
            <pre><code>elementBehaviors.define('click-counter', ClickCounter);</code></pre>
            <p>
                Then, apply the behavior to an element by adding a <code>has</code> attribute:
            </p>
            <pre><code>&lt;div has="click-counter"&gt;&lt;/div&gt;</code></pre>
            <h2 id="lifecycle-callbacks">Lifecycle Callbacks</h2>
            <p>
                Once your behavior is registered, the browser will call certain methods of your class when code in the page interacts with your behavior in certain ways. By providing an implementation of these methods, known as <i>lifecycle callbacks</i>, you can run code in response to these events.
            </p>
            <ul>
                <li>
                    connectedCallback(): Called when the element is attached to the DOM.
                </li>
                <li>
                    disconnectedCallback(): Called when the element is detached from the DOM.
                </li>
                <li>
                    adoptedCallback(): Called when the element is moved to a new document.
                </li>
                <li>
                    attributeChangedCallback(name, oldValue, newValue): Called when one of the observed attributes is changed. See Responding to attribute changes for more details about this callback.
                </li>
            </ul>
            <p>
                Here's a minimal Behavior that logs these lifecycle events:
            </p>
            <pre><code>// Create a class for the element
class ExampleLifecycleBehavior {
    static observedAttributes = ["color", "size"];

    constructor(element) {
        // Keep a reference to the element this instance belongs to
        this.#element = element;
    }

    connectedCallback() {
        console.log("Custom element added to page.");
    }

    disconnectedCallback() {
        console.log("Custom element removed from page.");
    }

    adoptedCallback() {
        console.log("Custom element moved to new page.");
    }

    attributeChangedCallback(name, oldValue, newValue) {
        console.log(`Attribute ${name} has changed.`);
    }
}

elementBehaviors.define("lifecycle-example", ExampleLifecycleBehavior);</code></pre>
            <h2 id="api-reference">API Reference</h2>
            <h3>elementBehaviors.define(name, behaviorClass)</h3>
            <p>
                Registers a new behavior class.
            </p>
            <ul>
                <li>
                    <code>name</code> (string): The name of the behavior.
                </li>
                <li>
                    <code>behaviorClass</code> (Class): The behavior class.
                </li>
            </ul>
            <h3>elementBehaviors.getBehaviorElements([limitToBehavior])</h3>
            <p>
                Returns an array of elements that have at least one behavior attached to them. You can limit this result to a specific behavior or subset of behaviors.
            </p>
            <ul>
                <li>
                    <code>limitToBehavior</code> (string, optional): A behavior name or behavior names separated by spaces to limit the results to. If not provided, all elements with behaviors are returned.
                </li>
            </ul>
            <h3>elementBehaviors.removeBehavior(element, behavior)</h3>
            <p>
                Removes a behavior including its state from an element.
            </p>
            <ul>
                <li>
                    <code>element</code> (HTMLElement|Array&lt;HTMLElement&gt;): An element or array of elements to remove the specified behaviors from.
                </li>
                <li>
                    <code>behavior</code> (string): A behavior or behaviors separated by spaces to remove from the specified element or elements.
                </li>
            </ul>
            <h3>elementBehaviors.version()</h3>
            <p>
                Returns the version of Element Behaviors in use.
            </p>
            <h2 id="limitations-and-modified-behavior">Limitations and Modified Behavior</h2>
            <p>
                Because Element Behaviors is not a native web standard there are some limitations and modified behaviors to be aware of:
            </p>
            <ul>
                <li>
                    Unlike other Element Behaviors libraries, behavior states are saved! Removing a behavior from an elements <code>has</code> attribute does not delete the state, allowing it to be preserved between document removals or document adoptions. If you no longer want a behaviors state permanently on an element, you must use the <code>removeBehavior</code> method to remove that behavior from an element.
                </li>
                <li>
                    Attaches behaviors to elements by using a non-standard (unhyphenated) <code>has</code> attribute on the elements.
                </li>
                <li>
                    Unhyphenated behavior names are supported in contrast to the Custom Elements standard of requiring hyphenated custom element names.
                </li>
                <li>
                    Closed shadow DOMs are not supported.
                </li>
                <li>
                    Shadow DOMs are supported by <a href="https://en.wikipedia.org/wiki/Monkey_patch" target="_blank">monkey patching</a> the <code>Element.prototype.attachShadow</code> method.
                </li>
                <li>
                    As expected, behavior elements are subject to the cross-origin security policy of iframes. 
                </li>
                <li>
                    Iframes not blocked by CORs policies are tracked by the parent document, but a script must be injected into the iframe to enable iframe shadow DOM support.
                </li>
            </ul>
            <h2 id="examples">Examples</h2>
            <p>
                Coming soon!
            </p>
        </main>
    </div>
</body>
</html>